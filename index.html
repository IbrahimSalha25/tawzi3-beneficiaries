<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="توزيع - نظام إدارة المساعدات الإنسانية" />
    <meta name="theme-color" content="#3cd37a" />
    <title>توزيع - Tawzi3</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="icon" href="assets/images/logo.png" type="image/png" />
  </head>
  <body>
    <!-- ============ Toast Container ============ -->
    <div class="toast-container" id="toast-container"></div>

    <!-- ============ Splash Screen ============ -->
    <div id="splash-screen">
      <div class="splash-logo">
        <img
          src="assets/images/logo.png"
          alt="توزيع"
          width="64"
          style="border-radius: 12px; height: auto"
        />
      </div>
      <h1>توزيع</h1>
      <p>نظام إدارة المساعدات الإنسانية</p>
      <div class="splash-spinner"></div>
    </div>

    <!-- ============ Login Screen ============ -->
    <div id="login-screen">
      <div class="login-container">
        <div class="login-logo">
          <img
            src="assets/images/logo.png"
            alt="توزيع"
            width="48"
            style="border-radius: 10px; height: auto"
          />
        </div>
        <h2>تسجيل الدخول</h2>
        <p class="login-subtitle">أدخل بياناتك للوصول إلى حسابك</p>

        <div class="error-message" id="login-error"></div>

        <form id="login-form">
          <div class="input-group">
            <label for="national-id">رقم الهوية</label>
            <input
              type="text"
              id="national-id"
              placeholder="أدخل رقم الهوية"
              required
              autocomplete="username"
            />
          </div>
          <div class="input-group">
            <label for="credential">رقم الهاتف أو كلمة المرور</label>
            <input
              type="text"
              id="credential"
              placeholder="أدخل رقم الهاتف أو كلمة المرور"
              required
              autocomplete="current-password"
            />
          </div>
          <button type="submit" class="btn" id="login-btn">تسجيل الدخول</button>
          <div class="spinner hidden" id="login-spinner"></div>
        </form>
      </div>
    </div>

    <!-- ============ Main Application ============ -->
    <div id="app">
      <!-- Header -->
      <header>
        <div class="header-brand">
          <img
            src="assets/images/logo.png"
            alt="توزيع"
            width="64"
            style="border-radius: 8px; height: auto"
          />
          <h1>توزيع</h1>
        </div>
        <div class="header-actions">
          <button class="icon-btn" id="qr-btn" title="عرض رمز QR">
            <svg
              width="22"
              height="22"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <rect x="3" y="3" width="7" height="7" />
              <rect x="14" y="3" width="7" height="7" />
              <rect x="3" y="14" width="7" height="7" />
              <rect x="14" y="14" width="3" height="3" />
              <line x1="21" y1="14" x2="21" y2="14.01" />
              <line x1="21" y1="21" x2="21" y2="21.01" />
              <line x1="17" y1="21" x2="17" y2="21.01" />
              <line x1="21" y1="17" x2="21" y2="17.01" />
            </svg>
          </button>
        </div>
      </header>

      <!-- Navigation -->
      <nav>
        <button class="nav-btn active" data-section="info">
          <span class="nav-icon">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
              <circle cx="12" cy="7" r="4" />
            </svg>
          </span>
          <span>المعلومات</span>
        </button>
        <button class="nav-btn" data-section="parcels">
          <span class="nav-icon">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
              />
              <polyline points="3.27 6.96 12 12.01 20.73 6.96" />
              <line x1="12" y1="22.08" x2="12" y2="12" />
            </svg>
          </span>
          <span>الطرود</span>
        </button>
        <button class="nav-btn" data-section="settings">
          <span class="nav-icon">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <circle cx="12" cy="12" r="3" />
              <path
                d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"
              />
            </svg>
          </span>
          <span>الإعدادات</span>
        </button>
      </nav>

      <!-- Content Area -->
      <div class="content">
        <!-- ======== Beneficiary Info Section ======== -->
        <div id="info" class="section active">
          <div class="spinner" id="info-spinner"></div>
          <div id="info-content" class="hidden">
            <!-- Profile Header -->
            <div class="card profile-header">
              <div class="profile-avatar">
                <svg
                  width="32"
                  height="32"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
              </div>
              <div class="profile-name" id="profile-name">---</div>
              <div class="profile-id" id="profile-id-display">---</div>
            </div>

            <!-- Camp Info -->
            <div class="card">
              <div class="card-title">
                <span class="card-icon">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                    <polyline points="9 22 9 12 15 12 15 22" />
                  </svg>
                </span>
                معلومات المخيم
              </div>
              <div class="info-row">
                <span class="info-label">اسم المخيم</span>
                <span class="info-value" id="camp-name">---</span>
              </div>
              <div class="info-row">
                <span class="info-label">الموقع</span>
                <span class="info-value" id="camp-location">---</span>
              </div>
              <div class="info-row">
                <span class="info-label">اسم المندوب</span>
                <span class="info-value" id="camp-representative">---</span>
              </div>
              <div class="info-row">
                <span class="info-label">هاتف المندوب</span>
                <span class="info-value" id="camp-rep-phone">---</span>
              </div>
            </div>

            <!-- Personal Info -->
            <div class="card">
              <div class="card-title">
                <span class="card-icon">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <rect x="2" y="5" width="20" height="14" rx="2" />
                    <line x1="2" y1="10" x2="22" y2="10" />
                  </svg>
                </span>
                المعلومات الشخصية
              </div>
              <div class="info-row">
                <span class="info-label">الاسم الكامل</span>
                <span class="info-value" id="head-name">---</span>
              </div>
              <div class="info-row">
                <span class="info-label">رقم الهوية</span>
                <span class="info-value" id="head-id">---</span>
              </div>
              <div class="info-row">
                <span class="info-label">رقم الهاتف</span>
                <span class="info-value" id="head-phone">---</span>
              </div>
            </div>

            <!-- Family Composition -->
            <div class="card">
              <div class="card-title">
                <span class="card-icon">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                  </svg>
                </span>
                تكوين الأسرة
              </div>
              <div class="family-grid">
                <div class="family-stat family-total">
                  <div class="stat-value" id="family-total">0</div>
                  <div class="stat-label">إجمالي أفراد الأسرة</div>
                </div>
                <div class="family-stat">
                  <div class="stat-value" id="males-0-2">0</div>
                  <div class="stat-label">ذكور 0-2</div>
                </div>
                <div class="family-stat">
                  <div class="stat-value" id="females-0-2">0</div>
                  <div class="stat-label">إناث 0-2</div>
                </div>
                <div class="family-stat">
                  <div class="stat-value" id="males-5-17">0</div>
                  <div class="stat-label">ذكور 5-17</div>
                </div>
                <div class="family-stat">
                  <div class="stat-value" id="females-5-17">0</div>
                  <div class="stat-label">إناث 5-17</div>
                </div>
                <div class="family-stat">
                  <div class="stat-value" id="males-17-60">0</div>
                  <div class="stat-label">ذكور 17-60</div>
                </div>
                <div class="family-stat">
                  <div class="stat-value" id="females-17-60">0</div>
                  <div class="stat-label">إناث 17-60</div>
                </div>
                <div class="family-stat">
                  <div class="stat-value" id="males-60-plus">0</div>
                  <div class="stat-label">ذكور 60+</div>
                </div>
                <div class="family-stat">
                  <div class="stat-value" id="females-60-plus">0</div>
                  <div class="stat-label">إناث 60+</div>
                </div>
                <div class="family-stat" style="grid-column: 1 / -1">
                  <div class="stat-value" id="disabled-count">0</div>
                  <div class="stat-label">ذوي الإعاقة</div>
                </div>
              </div>
            </div>

            <!-- Original Location -->
            <div class="card">
              <div class="card-title">
                <span class="card-icon">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                    <circle cx="12" cy="10" r="3" />
                  </svg>
                </span>
                الموقع الأصلي
              </div>
              <div class="info-row">
                <span class="info-label">المحافظة</span>
                <span class="info-value" id="governorate">---</span>
              </div>
              <div class="info-row">
                <span class="info-label">البلدة</span>
                <span class="info-value" id="town">---</span>
              </div>
              <div class="info-row">
                <span class="info-label">معلم بارز</span>
                <span class="info-value" id="landmark">---</span>
              </div>
            </div>
          </div>
        </div>

        <!-- ======== Parcels Section ======== -->
        <div id="parcels" class="section">
          <div class="spinner" id="parcels-spinner"></div>
          <div id="parcels-content" class="hidden">
            <div class="parcels-grid" id="parcels-grid"></div>
          </div>
        </div>

        <!-- ======== Settings Section ======== -->
        <div id="settings" class="section">
          <div class="settings-list">
            <div class="setting-item">
              <div class="setting-icon">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--primary)"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                  <circle cx="12" cy="7" r="4" />
                </svg>
              </div>
              <span class="setting-label" id="user-name-display"
                >اسم المستفيد</span
              >
            </div>

            <div class="setting-item" id="theme-toggle">
              <div class="setting-icon">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--primary)"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                </svg>
              </div>
              <span class="setting-label">الوضع الليلي</span>
              <div class="toggle-switch" id="theme-switch"></div>
            </div>

            <div class="setting-item" id="complaint-btn">
              <div class="setting-icon">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--primary)"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path
                    d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
                  />
                  <path
                    d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"
                  />
                </svg>
              </div>
              <span class="setting-label">تقديم شكوى</span>
              <span class="setting-arrow">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="15 18 9 12 15 6" />
                </svg>
              </span>
            </div>

            <div class="setting-item" id="change-password-btn">
              <div class="setting-icon">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--primary)"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                  <path d="M7 11V7a5 5 0 0 1 10 0v4" />
                </svg>
              </div>
              <span class="setting-label">تغيير كلمة المرور</span>
              <span class="setting-arrow">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="15 18 9 12 15 6" />
                </svg>
              </span>
            </div>

            <div
              class="setting-item"
              id="visit-website-btn"
              onclick="
                window.open(
                  'https://ibrahimsalha25.github.io/tawzi3system/',
                  '_blank',
                )
              "
            >
              <div class="setting-icon">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--primary)"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <circle cx="12" cy="12" r="10" />
                  <line x1="2" y1="12" x2="22" y2="12" />
                  <path
                    d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
                  />
                </svg>
              </div>
              <span class="setting-label">الموقع الالكتروني لنظام توزيع</span>
              <span class="setting-arrow">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="15 18 9 12 15 6" />
                </svg>
              </span>
            </div>

            <div class="setting-item danger" id="logout-btn">
              <div class="setting-icon">
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="var(--error)"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                  <polyline points="16 17 21 12 16 7" />
                  <line x1="21" y1="12" x2="9" y2="12" />
                </svg>
              </div>
              <span class="setting-label">تسجيل الخروج</span>
              <span class="setting-arrow">
                <svg
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="15 18 9 12 15 6" />
                </svg>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ MODALS ============ -->

    <!-- QR Code Modal -->
    <div class="modal-overlay" id="qr-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">
            <svg
              width="22"
              height="22"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <rect x="3" y="3" width="7" height="7" />
              <rect x="14" y="3" width="7" height="7" />
              <rect x="3" y="14" width="7" height="7" />
              <rect x="14" y="14" width="3" height="3" />
            </svg>
            رمز QR الخاص بك
          </h3>
          <button class="close-btn" onclick="closeModal('qr-modal')">✕</button>
        </div>
        <div class="qr-container">
          <div class="qr-box" id="qr-code"></div>
          <p class="qr-name" id="qr-name"></p>
          <p class="qr-id" id="qr-id-text"></p>
        </div>
      </div>
    </div>

    <!-- Parcel Details Modal -->
    <div class="modal-overlay" id="parcel-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">
            <svg
              width="22"
              height="22"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
              />
              <polyline points="3.27 6.96 12 12.01 20.73 6.96" />
              <line x1="12" y1="22.08" x2="12" y2="12" />
            </svg>
            تفاصيل الطرد
          </h3>
          <button class="close-btn" onclick="closeModal('parcel-modal')">
            ✕
          </button>
        </div>
        <div class="card">
          <div class="card-title">
            <span class="card-icon">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path
                  d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                />
                <polyline points="14 2 14 8 20 8" />
                <line x1="16" y1="13" x2="8" y2="13" />
                <line x1="16" y1="17" x2="8" y2="17" />
              </svg>
            </span>
            معلومات الطرد
          </div>
          <div class="info-row">
            <span class="info-label">اسم الطرد</span>
            <span class="info-value" id="detail-parcel-name">---</span>
          </div>
          <div class="info-row">
            <span class="info-label">النوع</span>
            <span class="info-value" id="detail-parcel-type">---</span>
          </div>
          <div class="info-row">
            <span class="info-label">حالة الطرد</span>
            <span class="info-value" id="detail-parcel-status">---</span>
          </div>
          <div class="info-row">
            <span class="info-label">التاريخ</span>
            <span class="info-value" id="detail-parcel-date">---</span>
          </div>
          <div class="info-row">
            <span class="info-label">الوصف</span>
            <span class="info-value" id="detail-parcel-desc">---</span>
          </div>
        </div>
        <div class="card mt-16">
          <div class="card-title">
            <span class="card-icon">
              <svg
                width="18"
                height="18"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <rect x="1" y="3" width="15" height="13" />
                <polygon points="16 8 20 8 23 11 23 16 16 16 16 8" />
                <circle cx="5.5" cy="18.5" r="2.5" />
                <circle cx="18.5" cy="18.5" r="2.5" />
              </svg>
            </span>
            حالة التوزيع
          </div>
          <div class="info-row">
            <span class="info-label">حالة الاستلام</span>
            <span class="info-value" id="detail-dist-status">---</span>
          </div>
          <div class="info-row">
            <span class="info-label">تاريخ التوزيع</span>
            <span class="info-value" id="detail-dist-date">---</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Complaint Modal -->
    <div class="modal-overlay" id="complaint-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">
            <svg
              width="22"
              height="22"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
              />
              <path
                d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"
              />
            </svg>
            تقديم شكوى
          </h3>
          <button class="close-btn" onclick="closeModal('complaint-modal')">
            ✕
          </button>
        </div>
        <div class="input-group">
          <label for="complaint-text">نص الشكوى</label>
          <textarea
            id="complaint-text"
            placeholder="اكتب شكواك هنا بالتفصيل..."
            rows="5"
          ></textarea>
        </div>
        <div class="modal-actions">
          <button
            class="btn btn-secondary"
            onclick="closeModal('complaint-modal')"
          >
            إلغاء
          </button>
          <button
            class="btn"
            id="submit-complaint-btn"
            onclick="submitComplaint()"
          >
            إرسال الشكوى
          </button>
        </div>
      </div>
    </div>

    <!-- Change Password Modal -->
    <div class="modal-overlay" id="password-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 class="modal-title">
            <svg
              width="22"
              height="22"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
              <path d="M7 11V7a5 5 0 0 1 10 0v4" />
            </svg>
            تغيير كلمة المرور
          </h3>
          <button class="close-btn" onclick="closeModal('password-modal')">
            ✕
          </button>
        </div>

        <!-- Step 1: Verify current credential -->
        <div id="password-step-verify" class="password-step">
          <div class="password-info" id="password-info-text">
            أدخل البيانات للتحقق من هويتك
          </div>
          <div class="input-group">
            <label for="verify-input" id="verify-label">التحقق</label>
            <input type="text" id="verify-input" placeholder="أدخل البيانات" />
          </div>
          <div class="modal-actions">
            <button
              class="btn btn-secondary"
              onclick="closeModal('password-modal')"
            >
              إلغاء
            </button>
            <button
              class="btn"
              id="verify-btn"
              onclick="verifyCurrentCredential()"
            >
              تحقق
            </button>
          </div>
        </div>

        <!-- Step 2: Set new password -->
        <div id="password-step-new" class="password-step">
          <div class="password-info">أدخل كلمة المرور الجديدة</div>
          <div class="input-group">
            <label for="new-password-input">كلمة المرور الجديدة</label>
            <input
              type="password"
              id="new-password-input"
              placeholder="أدخل كلمة المرور الجديدة (6 أحرف على الأقل)"
            />
          </div>
          <div class="input-group">
            <label for="confirm-password-input">تأكيد كلمة المرور</label>
            <input
              type="password"
              id="confirm-password-input"
              placeholder="أعد إدخال كلمة المرور الجديدة"
            />
          </div>
          <div class="modal-actions">
            <button
              class="btn btn-secondary"
              onclick="closeModal('password-modal')"
            >
              إلغاء
            </button>
            <button
              class="btn"
              id="save-password-btn"
              onclick="saveNewPassword()"
            >
              حفظ كلمة المرور
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ============ External Scripts ============ -->
    <!-- Firebase SDK (CDN compat) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <!-- QRCode.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <!-- App Modules (order matters: config → auth → data → main) -->
    <script src="js/firebaseConfig.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/beneficiary.js"></script>
    <script src="js/parcels.js"></script>
    <script src="js/complaints.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
